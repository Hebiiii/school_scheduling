# school_scheduling

小学校の時間割を自動生成する Streamlit アプリです。学年ごとのクラス数や教科設定を入力すると、教員や教室の重複を避けながら時間割を自動作成し、Excel 形式で出力できます。

## インストールと起動

1. Python と必要なライブラリをインストールします。
   ```bash
   pip install streamlit pandas numpy openpyxl
   ```
2. アプリを起動します。
   ```bash
   streamlit run streamlit.py
   ```

## アプリの使い方

1. **基本情報入力**
   - 学年ごとのクラス数と 6 限まで授業がある曜日を指定します。
   - デフォルトでは以下の曜日に 6 限があります。
     - 1 年生: なし
     - 2 年生: 水曜
     - 3 年生: 火曜
     - 4~6 年生: 火曜〜金曜
2. **教科ごとの設定**
   - 各教科のコマ数、担当教員、使用教室を設定します。
   - 初期状態では下表のコマ数が設定されています。

     |学年|英語|算数|国語|理科|社会|図工|音楽|体育|家庭科|総合|学活・道徳|生活|書写|
     |---|---|---|---|---|---|---|---|---|---|---|---|---|---|
     |1|0|4|9|0|0|2|2|3|0|0|1|3|0|
     |2|0|5|9|0|0|2|2|3|0|0|1|3|0|
     |3|1|5|7|2|2|1|2|3|0|2|1|0|0|
     |4|1|5|7|2|2|2|2|3|0|2|1|0|1|
     |5|2|5|5|2|3|1|1|3|2|2|1|0|1|
     |6|2|5|5|3|3|1|1|3|2|2|1|0|1|

   - 教員と教室の候補は教科ごとに用意されています。

     |教科|教員の候補|教室の候補|
     |---|---|---|
     |国語|担任/副担任|教室/特別教室|
     |算数|担任/副担任/算数教員|教室/特別教室|
     |英語|担任/副担任/英語教員(ALT)|教室/特別教室|
     |理科|担任/副担任/理科教員|教室/理科室|
     |社会|担任/副担任|教室/社会科室|
     |総合|担任/副担任|教室/特別教室|
     |学活・道徳|担任/副担任|教室/特別教室|
     |図工|担任/副担任/図工教員|教室/図工室|
     |音楽|担任/副担任/音楽教員|教室/音楽室(高学年用)/音楽室(低学年用)|
     |体育|担任/副担任/体育教員|教室/体育館・運動場|
     |家庭科|担任/副担任/家庭科教員|教室/家庭科室|
     |生活|担任/副担任/生活教員|教室/特別教室|
     |書写|担任/副担任/書写教員|教室/特別教室|

3. **詳細設定**
   - 曜日・時限の固定、時限制限、連続授業、クラス合同授業などの条件を追加できます。
4. **時間割の生成と出力**
   - ページ下部のボタンで時間割を生成し、クラス別・教員別などの Excel ファイルをダウンロードできます。

## エラー例と回避策

固定した曜日・時限に授業を割り当てる際、次のようなエラーが表示されることがあります:

```
1年1組の月曜3限には既に他の授業が設定されています。
```

このエラーは指定したコマが既に埋まっている場合に発生します。別の曜日・時限を選択するか、既存の設定を見直してください。

また、存在しない曜日・時限を指定した場合には次のようなメッセージが表示されます:

```
1年1組の月曜6限は時間割に存在しません。
```

この場合は、正しい曜日・時限を指定して再度実行してください。
